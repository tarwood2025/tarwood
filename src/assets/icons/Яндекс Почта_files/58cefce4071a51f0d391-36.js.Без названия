/*! For license information please see 58cefce4071a51f0d391-36.js.LICENSE */
webpackJsonp([36],{212:function(t,e,a){Jane.module("toolbar.js",function(){"use strict";a(4771),a(4773),a(4775)})},4771:function(t,e,a){a(4772)},4772:function(t,e){Daria.actions.define("toolbar.settings.button.remove",function(t,e){var a=e.button,n=Daria.userToolbar.deactivateButton(a);return _.isArray(n)&&(Daria.userToolbar.set(),ns.events.trigger("daria:vToolbarSettings:buttonToggled")),!1})},4773:function(t,e,a){a(4774)},4774:function(t,e){function a(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}function n(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}Daria.userToolbar={mSettings:function(){return this._mSettings||(this._mSettings=ns.Model.get("settings")),this._mSettings},_KEY:"tb_mail_mailbox",_KEY_ACTIVATED:"tb_mail_mailbox_act",_getSettingsValue:function(){var t=this.mSettings().getSetting(this._KEY);return Array.isArray(t)?t:_.isObject(t)&&t.default||[]},_cache:null,validate:function(t){return _.filter(t,function(t){switch(t.id){case Daria.Constants.TOOLBAR_BUTTONS.LABEL:var e=ns.Model.get("labels");return e&&e.getLabelById(t.settings.label);case Daria.Constants.TOOLBAR_BUTTONS.INFOLDER:var a=t.settings.tabId,n=t.settings.folder,i=a||n;return Boolean(Daria.areFoldersTabsEnabled()&&ns.Model.get("tabs").getTab(i))||ns.Model.get("folders").getFolderById(n);case Daria.Constants.TOOLBAR_BUTTONS.SENDON:return t.settings.email&&Jane.FormValidation.checkEmail(t.settings.email)}return!0})},get:function(t){return _.isNull(this._cache)&&(this._cache=this._getSettingsValue()),this._cache=this.validate(this._cache),t?this._getSettingsByButtonId(this._cache,t)||null:this._cache},_getActionsSettings:function(t){t=t||this._cache;var e=this.mSettings().getSetting(this._KEY);return _.isObject(e)?function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach(function(e){n(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}({},e,{default:t}):{default:t}},set:function(t){var e=new Vow.Promise;return this.mSettings().setSettings(n({},this._KEY,this._getActionsSettings(t)),function(a){a?e.fulfill(t):e.reject("error set settings for user toolbar")}),e},activate:function(){var t=new Vow.Promise;return this.mSettings().setSettingOn(this._KEY_ACTIVATED,function(){t.fulfill()}),t},isActivated:function(){return!Daria.Config.NO_SETTINGS&&this.mSettings().isSet(this._KEY_ACTIVATED)},getCustomizableButtonName:function(t){var e=this.get(t);if(e)switch(t){case Daria.Constants.TOOLBAR_BUTTONS.LABEL:return ns.Model.get("labels").getLabelById(e.settings.label).name;case Daria.Constants.TOOLBAR_BUTTONS.INFOLDER:var a=e.settings.folder;if(Daria.areFoldersTabsEnabled()){var n=e.settings.tabId,i=n||a,o=ns.Model.get("tabs").getTab(i);return o?o.get(".title"):ns.Model.get("folders").getFolderById(a).name}return ns.Model.get("folders").getFolderById(a).name;case Daria.Constants.TOOLBAR_BUTTONS.SENDON:return e.settings.email;default:return}},activateButton:function(t,e){var a={id:t,settings:e},n=_.findIndex(this._cache,{id:t});return-1!==n?this._cache[n]=a:this._cache.push(a),this._cache},deactivateButton:function(t){return this._cache=_.reject(this._cache,{id:t}),this._cache},isButtonActivated:function(t){return _.isNull(this._cache)&&(this._cache=this._getSettingsValue()),Boolean(this._getSettingsByButtonId(this._cache,t))},invalidateCache:function(){this._cache=null},_getSettingsByButtonId:function(t,e){return _.find(t,{id:e})}}},4775:function(t,e,a){a(4776),a(4777),a(4778),a(4779)},4776:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(136);a.n(n);!function(){var t=[{id:Daria.Constants.TOOLBAR_BUTTONS.MAIN_SELECT_ALL,action:"select-all",iconId:"mail--Inbox-CheckboxCheckMark-Small",title:i18n("%Shortcuts_key_Select_all"),accessKey:Daria.Shortcuts.getShortcutLabelFor("Select_all","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.MAIN_DESELECT_ALL,action:"deselect-all",iconId:"mail--Inbox-CheckboxCheckMark-Small",title:i18n("%Toolbar_Снять_выделение"),accessKey:Daria.Shortcuts.getShortcutLabelFor("Select_all","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.DRAFT_FINISH,icon:"Compose",name:i18n("%Toolbar_Дописать"),title:i18n("%Toolbar_Дописать")},{id:Daria.Constants.TOOLBAR_BUTTONS.ADD_TEMPLATE,icon:"AddTemplate",name:i18n("%Toolbar_Создать_шаблон")},{id:Daria.Constants.TOOLBAR_BUTTONS.EDIT,action:"compose-edit",icon:"Edit",name:i18n("%Изменить"),_visible:function(){if(!Daria.isMessagePage())return!1;var t=ns.Model.get("messages-checked");if(1!==t.getCount())return!1;var e=t.getCheckedMessages()[0];return ns.Model.get("folders").isFolder(e.getFolderId(),n.DraftTemplateLikeFoldersShort)}},{id:Daria.Constants.TOOLBAR_BUTTONS.DELETE,action:"remove",folderAction:"folder.messages-remove",icon:"Delete",actionParams:function(){var t={};return"message"===Daria.router.getCurrentPage()&&(t.ignoreUnsavedDraft=!0),t},name:i18n("%Toolbar_Удалить"),title:i18n("%Toolbar_Удалить")+Daria.Shortcuts.getShortcutLabelFor("Delete_selected","messages",!0),accessKey:Daria.Shortcuts.getShortcutLabelFor("Delete_selected","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.SPAM,action:"tospam",icon:"Spam",name:i18n("%Toolbar_Это_спам"),title:i18n("%Toolbar_Это_спам")+Daria.Shortcuts.getShortcutLabelFor("Label_spam","message",!0),accessKey:Daria.Shortcuts.getShortcutLabelFor("Label_spam","message")},{id:Daria.Constants.TOOLBAR_BUTTONS.NOT_SPAM,action:"notspam",icon:"Unspam",name:i18n("%Toolbar_Не_спам")},{id:Daria.Constants.TOOLBAR_BUTTONS.MARK_AS_READ,action:"mark",folderAction:"folder.current-mark-read",icon:"Read",name:i18n("%Toolbar_Прочитано"),title:i18n("%Toolbar_Прочитано")+Daria.Shortcuts.getShortcutLabelFor("Label_read","messages",!0),accessKey:Daria.Shortcuts.getShortcutLabelFor("Label_read","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.MARK_AS_UNREAD,action:"unmark",icon:"Unread",name:i18n("%Toolbar_Не_прочитано"),title:i18n("%Toolbar_Не_прочитано")+Daria.Shortcuts.getShortcutLabelFor("Label_unread","messages",!0),accessKey:Daria.Shortcuts.getShortcutLabelFor("Label_unread","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.UNSUBSCRIBE_ONE,action:"unsubscribe-one",icon:"Unsubscribe_all",name:i18n("%Toolbar_Unsubscribe_One")},{id:Daria.Constants.TOOLBAR_BUTTONS.UNSUBSCRIBE_ALL,action:"unsubscribe-all",icon:"Unsubscribe_all",name:i18n("%Toolbar_Unsubscribe_All")},{id:Daria.Constants.TOOLBAR_BUTTONS.REPLY_LATER,name:i18n("%Toolbar_Reply_Later"),icon:"Reply_later",nameArrow:!0},{id:Daria.Constants.TOOLBAR_BUTTONS.ARCHIVE,action:"archive",icon:"Archive",name:i18n("%Toolbar_Archive"),title:i18n("%Toolbar_Archive")+Daria.Shortcuts.getShortcutLabelFor("Archive","messages",!0),description:i18n("%Toolbar_Archive_Description"),settings:{},accessKey:Daria.Shortcuts.getShortcutLabelFor("Archive","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.MARK_IMPORTANT,action:"mark-important",icon:"MarkImportant",name:i18n("%Labels_Toolbar_Important"),title:i18n("%Labels_Toolbar_Important")+Daria.Shortcuts.getShortcutLabelFor("Label_important","messages",!0),accessKey:Daria.Shortcuts.getShortcutLabelFor("Label_important","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.MARK_UNIMPORTANT,action:"mark-unimportant",icon:"MarkUnimportant",name:i18n("%Labels_Toolbar_Important"),title:i18n("%Labels_Toolbar_Important")+Daria.Shortcuts.getShortcutLabelFor("Label_important","messages",!0),accessKey:Daria.Shortcuts.getShortcutLabelFor("Label_important","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.LABELS_ACTIONS,icon:"Tag",name:i18n("%Toolbar_Label"),nameArrow:!0,title:i18n("%Toolbar_Label")+Daria.Shortcuts.getShortcutLabelFor("Labels_dialog","messages",!0),description:i18n("%Toolbar_Label_Description"),accessKey:Daria.Shortcuts.getShortcutLabelFor("Labels_dialog","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.FOLDERS_ACTIONS,icon:"Folder",name:i18n("%Toolbar_Infolder"),nameArrow:!0,title:i18n("%Toolbar_Infolder")+Daria.Shortcuts.getShortcutLabelFor("Folders_dialog","messages",!0),description:i18n("%Toolbar_Infolder_Description"),accessKey:Daria.Shortcuts.getShortcutLabelFor("Folders_dialog","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.PIN,action:"pin",icon:"Pin",name:i18n("%Pinned_Запинить_письмо"),_visible:function(){if(Daria.isMessagePage()){var t=ns.Model.get("messages-checked");if(1===t.getCount()){var e=t.getCheckedMessages()[0];return!ns.Model.get("folders").isFolder(e.getFolderId(),n.DraftTemplateLikeFoldersShort)}}return!0}},{id:Daria.Constants.TOOLBAR_BUTTONS.UNPIN,action:"unpin",icon:"Pin_active",name:i18n("%Pinned_Распинить_письмо"),_visible:function(){if(Daria.isMessagePage()){var t=ns.Model.get("messages-checked");if(1===t.getCount()){var e=t.getCheckedMessages()[0];return!ns.Model.get("folders").isFolder(e.getFolderId(),n.DraftTemplateLikeFoldersShort)}}return!0}},{id:Daria.Constants.TOOLBAR_BUTTONS.INFOLDER,action:"infolder",icon:"MagicFolder",name:i18n("%Toolbar_Infolder"),originalName:i18n("%Toolbar_Infolder"),title:i18n("%Toolbar_Infolder")+Daria.Shortcuts.getShortcutLabelFor("Infolder","messages",!0),description:i18n("%Toolbar_Infolder_Description"),settings:{folder:null},settingsDeps:function(){return Daria.areFoldersTabsEnabled()?["folders","tabs"]:["folders"]},isCustom:!0,_settingsValidate:function(t){var e=[];if(t.folder||e.push("folder_empty"),Daria.areFoldersTabsEnabled()&&/tab/.test(t.folder)){var a=ns.Model.get("folders").getFidBySymbol(n.WellKnownFolderSymbol.INBOX);t.tabId=t.folder.substring(4),t.folder=a}return e},accessKey:Daria.Shortcuts.getShortcutLabelFor("Infolder","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.LABEL,action:"toggleLabel",icon:"MagicTag",name:i18n("%Toolbar_Label"),originalName:i18n("%Toolbar_Label"),title:i18n("%Toolbar_Label")+Daria.Shortcuts.getShortcutLabelFor("Defined_label","messages",!0),description:i18n("%Toolbar_Label_Description"),settings:{label:null},settingsDeps:["labels"],isCustom:!0,_settingsValidate:function(t){var e=[];return t.label||e.push("label_empty"),e},accessKey:Daria.Shortcuts.getShortcutLabelFor("Defined_label","messages")},{id:Daria.Constants.TOOLBAR_BUTTONS.MORE,icon:"More",name:i18n("%Toolbar_More")},{id:Daria.Constants.TOOLBAR_BUTTONS.TOOLBAR_SETTINGS,action:"customize",iconId:"mail--Settings",name:i18n("%Toolbar_Settings"),settings:{},settingsHide:!0},{id:Daria.Constants.TOOLBAR_BUTTONS.ABOOK_SELECT_ALL,action:"abook.select-all",iconId:"mail--Inbox-CheckboxCheckMark-Small",title:i18n("%АК_Выделить_все_контакты")},{id:Daria.Constants.TOOLBAR_BUTTONS.ABOOK_DESELECT_ALL,action:"abook.deselect-all",iconId:"mail--Inbox-CheckboxCheckMark-Small",title:i18n("%Toolbar_Снять_выделение")},{id:Daria.Constants.TOOLBAR_BUTTONS.ABOOK_ADD,action:"mail-common.person-popup",iconId:"mail--MainToolbar-AddContact",name:i18n("%Toolbar_Добавить_контакт")},{id:Daria.Constants.TOOLBAR_BUTTONS.ABOOK_REMOVE,action:"abook.remove-contacts",iconId:"mail--MainToolbar-Delete",name:i18n("%Toolbar_Удалить"),droppable:!0},{id:Daria.Constants.TOOLBAR_BUTTONS.ABOOK_TO_GROUP,action:"abook.groups-dropdown",iconId:"mail--MainToolbar-AddGroup",name:i18n("%АК_Добавить_в_группу"),droppable:!0},{id:Daria.Constants.TOOLBAR_BUTTONS.ABOOK_OUT_OF_GROUP,action:"abook.remove-contacts-from-group",iconId:"mail--MainToolbar-DeleteGroup",name:i18n("%АК_Удалить_из_группы"),droppable:!0},{id:Daria.Constants.TOOLBAR_BUTTONS.ABOOK_RESTORE,action:"abook.open-backups-dialog",iconId:"mail--MainToolbar-Restored",name:i18n("%AK_Восстановить")},{id:Daria.Constants.TOOLBAR_BUTTONS.ABOOK_MORE,action:"abook.toolbar-more-actions",iconId:"mail--MainToolbar-More",name:i18n("%Toolbar_More")},{id:Daria.Constants.TOOLBAR_BUTTONS.TRANSLATE,action:"translate.show-infoline",name:i18n("%Message_Translate"),iconId:"mail--MainToolbar-Translate",_visible:ns.False},{id:Daria.Constants.TOOLBAR_BUTTONS.PRINT,name:i18n("%Message_Распечатать"),_visible:ns.False,_getExData:function(){return{href:"".concat(Daria.api.print,"?mid=").concat(Daria.router.getCurrentParams().ids,"&_uid=").concat(Daria.uid),attrs:{target:"_blank"}}}},{id:Daria.Constants.TOOLBAR_BUTTONS.FILTERS_CREATE,name:i18n("%Message_Создать_правило"),_visible:ns.False,_getExData:function(){return{href:"#setup/filters-create?message="+Daria.router.getCurrentParams().ids,class:["ns-action"],attrs:{"data-click-action":"message.counter-filters-create"}}}},{id:Daria.Constants.TOOLBAR_BUTTONS.MESSAGE_SOURCE,name:i18n("%Message_Свойства_письма"),_visible:ns.False,_getExData:function(){var t=Daria.router.getCurrentParams().ids;return{href:"".concat(Daria.api["message-source"],"/").concat(Daria.uid,"/").concat(t,"/yandex_email.eml"),class:["ns-action","js-toolbar-item-message-properties"],attrs:{target:"_blank","data-click-action":"message.counter-properties"}}}}];ns.Model.define("all-toolbar-buttons",{events:{"ns-model-init":"onInit"},methods:{onInit:function(){this.setData(t)},getButtonById:function(t){return _.find(this.getData(),{id:t})},getButtonsByIds:function(t){return _.filterValuesContainingPropValue(this.getData(),"id",t)},getOrExtendButton:function(t){return _.isString(t)?this.getButtonById(t):_.extend({},this.getButtonById(t.id),t)},getButtonsByDeclarations:function(t){return _.map(t,this.getOrExtendButton,this)}}})}()},4777:function(t,e){ns.Model.define("toolbar",{split:{items:".item",params:{id:".id"},model_id:"toolbar-button"},params:{layout:null},events:{"ns-model-init":"onInit"},methods:{onInit:function(){this.setData({buttons:[]})},preprocessData:function(t){return t.buttons&&(t.item=t.buttons),delete t.buttons,t.fixed=!1,t},setFixedSupport:function(t){Jane.watcher.set("toolbar.allowfixed",Boolean(t))},getFixedSupport:function(){return Jane.watcher.get("toolbar.allowfixed")},toggleFixed:function(t){return this.get(".fixed")!==t&&(this.set(".fixed",t),!0)},isFixed:function(){return Boolean(this.get(".fixed"))},areSettingsEnabled:function(){return Boolean(this.get(".settings"))},getById:function(t){return _.find(this.models,function(e){return e.get(".id")===t})}}},ns.ModelCollectionStatic)},4778:function(t,e){!function(){var t=function(){return Vow.fulfill()};ns.Model.define("toolbar-button",{params:{id:null},ctor:function(){this.toShow=no.True,this.toEnable=no.True,this.init=no.nop,this.getSettingsDepsParams=t,this.validateSettings=no.True,this.getExData=_.noop,this.getSettingsDeps=this._getSettingsDeps.bind(this)},methods:{hasDataChanged:function(){return Boolean(!this.data)},preprocessData:function(e){var a=e._visible;return this.toShow=a||no.True,a=e._enable,this.toEnable=a||no.True,a=e._init,this.init=a||no.nop,a=e._settingsDepsParams,this.getSettingsDepsParams=a||t,"function"==typeof e.settingsDeps&&(this.getSettingsDeps=e.settingsDeps),a=e._settingsValidate,this.validateSettings=a||no.True,this.getExData=e._getExData||_.noop,_.pick(e,function(t,e){return"_"!==e.charAt(0)})},setName:function(t){_.isUndefined(t)?this.resetName():this.setIfChanged(".name",t)},resetName:function(){var t=this.get(".originalName");t&&this.set(".name",t)},isModelWithSettings:function(){return Boolean(this.get(".settings"))},getType:function(){return this.get(".type")},_getSettingsDeps:function(){return this.get(".settingsDeps")},isValid:no.True}},ns.ModelStatic)}()},4779:function(t,e){ns.Model.define("mops-confirmation",{events:{"ns-model-init":"onInit"},methods:{onInit:function(){this.setData({})},getData:function(){return this.getMops()},getMops:function(){return{action:this.data.action||null,callback:this.data.callback||null,onCancel:this.data.onCancel||null,count:this.data.count||0}},setMops:function(t){this.setData(t)}}},ns.ModelStatic),Daria.actions.define("mops-confirmation.clear",function(){ns.Model.get("mops-confirmation").setMops({})})}});